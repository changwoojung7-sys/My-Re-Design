# 📢 [업데이트] v2.0.6 (Version Code 26) 배포 안내

안녕하세요, **My Re Design**입니다!
모바일 기기에서 결제 취소 시 간헐적으로 발생하던 빈 화면 오류를 완벽히 해결한 **v2.0.6** 업데이트를 배포했습니다.

### 💳 결제 시스템 안정성 및 사용자 경험 복구

#### 1. 안드로이드 PG사 결제 취소 시 복귀 에러 해결

* **문제**: 모바일 환경에서 외부 카드사 앱 결제 진행 중, '취소'나 '뒤로가기'를 눌렀을 때 앱으로 돌아오지 못하고 하얀 화면 중앙에 `http://null/` 및 `ERR_CLEARTEXT_NOT_PERMITTED` 오류가 발생하는 크리티컬한 문제가 있었습니다.
* **원인**: 안드로이드 운영체제의 최신 보안 정책이 결제 라벨링된 트래픽 응답에서 순수 `https://` 외의 커스텀 앱 주소(`myredesign://...`)를 잠재적 위협으로 간주하여 중간에 차단(Cleartext Traffic Block)해버렸기 때문입니다.
* **수정 사항 (Edge 브릿지 기술 적용)**:
  * 결제 취소 응답을 처리하는 전용 **안전 보안 브릿지 서버(Supabase Edge Function)**를 새롭게 구축했습니다.
  * 신용카드 앱에서 앱으로 직접 돌아오지 않고, 중간에 이 안전한 브릿지(HTTPS)를 0.1초 만에 거치도록 우회하여 안드로이드 보안망을 정상 통과하도록 구현했습니다.
* **효과**: 이제 결제 진행 중 마음이 바뀌어 취소하거나, 오류가 발생해 앱으로 돌아올 때 아무런 경고창이나 오류 화면 강제 종료 없이 깔끔하게 "결제가 취소되었습니다" 알림과 함께 기존 구독 관리 화면으로 부드럽게 돌아옵니다!

---

# 📢 [업데이트] v2.0.5 (Version Code 25) 배포 안내

사용자 피드백을 반영하여 앱의 접근성을 더욱 개선하고 무료 혜택 기간 중 미션 표시 방식을 정상화한 **v2.0.5** 업데이트를 배포했습니다.

### 🌟 앱 접근성(Accessibility) 개선

#### 1. 스크린 리더 인식률 향상 (마이페이지 & 관리자 화면)

* **문제**: 마이페이지의 정보 설정(키, 몸무게, 언어 선택 등) 입력 요소와 관리자 화면의 일부 버튼에서 스크린 리더용 텍스트가 시각 장애인에게 읽히지 않는 접근성 경고가 있었습니다.
* **수정 사항**: `title`과 `placeholder` 속성이 누락되었던 20여 곳 이상의 입력창(`input`), 드롭다운(`select`), 닫기 버튼 요소들에 모두 명시적인 텍스트 라벨링을 추가하여 국제 웹 접근성 표준에 맞게 개선했습니다.
* **효과**: 이제 보이스오버(VoiceOver)나 톡백(TalkBack) 등 화면 읽기 프로그램을 사용하는 분들도 앱의 세부 설정을 정확히 인지하고 손쉽게 조작할 수 있습니다.

### 🎁 무료 체험 사용자 혜택 연장 적용

#### 2. Trial Phase 3 미션 표시 로직 수정

* **기존**: 무료 체험자의 경우 가입 후 22일~30일차(Phase 3)가 되면 제공되는 미션이 3개에서 1개로 급격히 제한되는 하드코딩된 제약이 존재했습니다.
* **수정 사항**: 사용자들의 원활한 한 달(30일) 루프 완성을 돕기 위해 해당 제약을 완전히 삭제했습니다.
* **효과**: 이제 **무료 체험 가입 후 30일까지** 지속적으로 기본 할당된 **핵심 미션 3개가 매일 정상적으로 제공**됩니다.

---

# 📢 [업데이트] v2.0.4 (Version Code 24) 배포 안내

안녕하세요, **My Re Design**입니다!
안드로이드 기기에서의 결제 환경을 근본적으로 개선하고, 앱 접근성을 향상시킨 **v2.0.4** 업데이트를 배포했습니다.

### 💳 결제 시스템 네이티브 최적화

#### 1. 안드로이드 결제 모듈(앱카드) 호출 멈춤 현상 해결

* **문제**: 삼성페이, KB국민카드, ISP 등 외부 앱카드 앱 호출 시, 안드로이드 모바일 기기(Galaxy S25 등)에서 웹뷰 화면이 하얗게 멈추거나 반응하지 않는 현상이 있었습니다.
* **원인**: 웹앱 프레임워크인 Capacitor의 기본 설정이 외부 앱을 실행하는 특수 문자열(`intent://` 방식)을 보안 및 라우팅 문제로 잡아내지 못하고 있었습니다.
* **수정 사항 (근본적 해결)**:
  * 안드로이드 OS 가장 밑단인 `MainActivity.java`의 **WebViewClient를 직접 오버라이딩**하여 설계했습니다.
  * 이제 웹앱에서 외부 카드 앱을 호출할 때 발생하는 모든 `intent://` 요청을 안드로이드 네이티브가 직접 가로채어 해당 앱을 안전하고 확실하게 실행합니다.

#### 2. PG사 결제 완료 후 앱 복귀(Deep Link) 구현

* **기존**: 결제가 끝난 후 돌아올 곳이 `localhost` 형태의 웹 주소로 되어있어, 모바일 기기에서는 기존 쓰던 앱으로 돌아오지 못하고 헤매는 문제가 있었습니다.
* **수정 사항**:
  * 앱에 `myredesign://` 이라는 고유 주소(슈퍼 패스)를 부여했습니다. (`AndroidManifest.xml` 세팅)
  * 이제 외부 앱에서 결제 성공/취소 시 이 고유 주소를 통해 기존 화면으로 완벽히 복귀합니다.
  * 복귀 직후 프론트엔드가 이를 감지(`@capacitor/app` 리스너 활용)하여, 즉시 백그라운드 서버 포트원(PortOne) 데이터와 교차 검증하고 결제 결과를 즉각 화면에 알려줍니다.

### 🌟 앱 접근성(Accessibility) 개선

#### 3. 리워드 광고 UI 접근성 강화

* **문제**: 동영상 리워드 광고 화면의 '음소거' 및 '닫기(X)' 아이콘 버튼이 시각장애인용 스크린 리더기에서 읽히지 않는 웹 접근성 경고가 있었습니다.
* **수정 사항**: 해당 버튼들에 마우스 호버 시 나오는 텍스트(`title`)와 스크린 리더용 읽기 텍스트(`aria-label`)를 모두 완벽히 추가하여 국제 웹 접근성 표준을 준수하도록 개선했습니다.

---

# 📢 [업데이트] v2.0.3 (Version Code 23) 배포 안내

안녕하세요, **My Re Design**입니다!
결제 시스템의 안정성을 강화하고 관리자 기능을 개선한 **v2.0.3** 업데이트를 배포했습니다.

### 🛡️ 결제 시스템 안정성 강화

#### 1. 모바일 결제 취소 처리 개선 💳

* **문제**: 모바일 결제 시 사용자가 결제창의 닫기(X) 버튼을 눌러 취소했음에도, 앱 복귀 시 간혹 '결제 성공'으로 잘못 처리되는 현상이 있었습니다.
* **원인**: 결제 취소 시 명확한 실패 신호 없이 리다이렉트되는 경우, 기존 로직이 이를 성공으로 오인하는 허점이 있었습니다.
* **수정**: 리다이렉트 결과 검증 로직을 **엄격하게 강화**했습니다. 이제 PG사로부터 명확한 '성공(true)' 신호를 받지 못하면 무조건 **결제 실패/취소**로 처리하여, 잘못된 과금이나 구독 활성화를 원천 차단했습니다.
* **효과**: 결제 중단/취소 시 정확하게 '결제 실패/취소' 알림이 표시되며, 미결제 상태가 'Paid'로 남는 문제를 해결했습니다.

### 🛠️ 관리자(Admin) 기능 개선

#### 2. 미션 히스토리 가시성 향상 📜

* **문제**: 관리자 페이지에서 사용자의 과거 미션(FunPlay 등)이 만료되었음에도 'D+N일'로만 표시되어 상태 파악이 어려웠습니다.
* **수정**: 만료된 미션은 **'Ended'** 배지와 함께 종료일이 명확히 표시되도록 UI를 개선했습니다. 성공한 미션은 **'Success'**로 구분됩니다.

#### 3. 결제 강제 취소 기능 추가 🚫

* **기능**: 관리자가 사용자의 결제 내역을 직접 취소할 수 있는 기능을 추가했습니다. 결제 후 2일 이내의 건에 대해 즉시 취소 처리가 가능합니다.

---

# 📢 [업데이트] v2.0.1 (Version Code 21) 배포 안내

안녕하세요, **My Re Design**입니다!
주요 버그 수정 및 사용자 경험 개선을 포함한 **v2.0.0** 업데이트를 배포했습니다.

### 🐛 버그 수정

#### 1. FunPlay 미션 만료 버그 수정 🎮

* **문제**: FunPlay 카테고리의 미션이 설정된 기간(`duration_months`)과 관계없이 항상 7일 후 만료되는 버그가 있었습니다.
* **원인**: `Today.tsx`의 `isGoalExpired()`와 `MyPage.tsx`의 `isGoalExpired()`, `isGoalItemExpired()` 함수에서 FunPlay 카테고리에 대해 `totalDays = 7`로 하드코딩되어 있었습니다.
* **수정**: 하드코딩된 7일 만료 로직을 제거하여, FunPlay 미션도 다른 카테고리와 동일하게 `duration_months` 값에 따라 정상적으로 만료되도록 수정했습니다.
* **영향 범위**: 미션 탭(Today), 마이페이지(MyPage)의 목표 필터링 및 콤보 표시

### ✨ 개선 사항

#### 2. 미션 로딩 애니메이션 개선 🎬

* **문제**: 미션 생성/새로고침 중 표시되는 로딩 애니메이션이 스크롤 시 화면 밖으로 사라지거나, `fixed` 위치 사용 시 전체 화면을 가리는 문제가 있었습니다.
* **수정**: 미션 리스트 영역을 `relative` 래퍼로 감싸고, `MissionLoading` 오버레이를 스크롤 영역 외부에 `absolute inset-0`으로 배치하여 미션 리스트 영역만 덮도록 구조를 개선했습니다.
* **효과**: 로딩 중에도 하단 네비게이션이 보이고, 스크롤해도 애니메이션이 고정 표시됩니다.

### 📝 문서화

#### 3. Context.md 전면 업데이트 📖

* **화면별 상세 기능**: 8개 화면(Today, Dashboard, History, Friends, MyPage, Onboarding, Login, Admin)의 세부 기능을 함수 수준까지 상세 기술
* **구독/유료화 모델 추가**: Trial Phase 4단계, Mission Plan / All Access Plan 가격표, PortOne V1/V2 결제 흐름, 연장/취소 정책 전체 문서화
* **데이터 모델 확장**: 12개 주요 테이블 정의 추가
* **라우팅 구조**: App.tsx 기반 8개 경로 매핑 테이블 추가

---

# 📢 [업데이트] v1.9.7 (Version Code 17) 배포 안내

안녕하세요, **My Re Design**입니다!
더욱 정교한 미션 생성과 편리한 데이터 관리를 위해 **안드로이드 v1.9.7** 업데이트를 배포했습니다.

### 🚀 주요 개선 사항

#### 1. AI 미션 생성 프롬프트 고도화 🧠

* **목표 우선순위 개선**: 사용자가 설정한 목표(Goal)가 패턴(Pattern)보다 절대적으로 우선하도록 프롬프트 구조를 재설계했습니다.
  * **Goal = TOPIC** (미션의 주제), **Pattern = METHOD HINT** (접근 방법 힌트)로 역할을 명확히 분리
  * 목표와 패턴이 충돌할 때 목표가 반드시 우선하는 규칙 추가
* **클라이언트 목표 우선**: 사용자가 현재 선택한 콤보의 목표가 DB 기본값보다 우선 적용됩니다.
* **미션 히스토리 반영**: 최근 7일간의 미션 핑거프린트(Fingerprint)를 AI에 전달하여 반복 미션 생성을 방지합니다.

#### 2. 히스토리 미션 삭제 기능 🗑️

* **수정 모드 추가**: 히스토리 상세 화면에 ✏️ **수정** 버튼을 추가하여 편집 모드를 활성화할 수 있습니다.
* **개별 미션 삭제**: 편집 모드에서 완료된 미션을 개별적으로 삭제할 수 있으며, 연결된 사진/영상 파일도 함께 정리됩니다.
* **삭제 확인 다이얼로그**: 미션 내용 미리보기와 함께 삭제 전 확인 절차를 제공합니다.

#### 3. My Page 목표 필터 기능 🎯

* **진행중인 미션 / 완료된 미션 토글**: 집중 영역(Focus Area) 옆에 상태 필터를 추가하여 목표를 구분할 수 있습니다.
* **완료된 미션 리스트**: 만료되거나 완료된 목표를 카드 형태로 나열하며, 카테고리·목표명·시작일을 한눈에 확인할 수 있습니다.
* **완료 목표 삭제**: 수정 모드에서 완료된 목표와 관련된 모든 데이터(미션, 스토리지, 소셜 데이터)를 일괄 삭제할 수 있습니다.

#### 4. 미션 생성 프로세스 문서화 📝

* **Prompt.md 전면 재작성**: 클라이언트 호출 → Edge Function → AI 프롬프트 → 응답 처리 → DB 저장까지의 전체 파이프라인을 상세히 문서화했습니다.

---

# 📢 [업데이트] v1.9.5 (Version Code 15) 배포 안내

안녕하세요, **My Re Design**입니다!
사용자 여러분께 더욱 풍성한 경험과 안정적인 환경을 제공하기 위해 **안드로이드 v1.9.5** 업데이트를 배포했습니다.

### 🚀 주요 개선 사항

#### 1. 무료 이용 혜택 및 단계별 정책 안내 🎁

더 많은 분이 성장의 즐거움을 체험하실 수 있도록 무료 이용 정책을 체계화했습니다.

* **신규 가입자 무제한 혜택**: 가입 후 첫 7일(Phase 1) 동안은 프리미엄 기능을 아무런 제약 없이 무료로 이용하실 수 있습니다.
    ** FunPlay 카테고리는 무제한 이용 가능 합니다.
* **단계별 적응 프로세스**: 체험 기간에 따라 효율적인 습관 형성을 돕는 4단계 프로세스가 적용됩니다.
  * **Phase 1 (1~7일)**: 모든 프리미엄 기능 무제한 무료 체험
  * **Phase 2 (8~21일)**: 히스토리 Play Movie 재생시 광고 시청을 통해 실행 가능
  * **Phase 3 (22~30일)**: 핵심 미션(1개)만 생성, Play Movie 재생시 광고 기반 혜택 지원
  * **Phase 4 (31일 이후)**: 구독을 통한 지속적인 프리미엄 루프 완성

#### 2. 앱 안정성 및 최신 기기 최적화 🛠️

* **무한 로딩 방지**: 최신 기기(갤럭시 S25 등)에서 간헐적으로 발생하던 화면 멈춤 및 블랭크 화면 현상을 해결하여 안정성을 대폭 강화했습니다.
* **오류 복구 로직 강화**: 데이터 생성 중 발생할 수 있는 예외 상황에 유연하게 대응하도록 보완했습니다.

#### 3. 미션 시스템 가독성 개선 🎯

* **미션탭은 진행중인 미션만 노출**: 같은 카테고리에 여러 Goal이 있을 경s우, 진행중인 미션 하나만 노출되도록 필터링하여 루프 관리의 편의성을 높였습니다.

#### 4. 코드 최적화 및 버그 수정 ✨

* 미션 선택 및 데이터 새로고침 시의 참조 오류를 수정하고 데이터 처리 성능을 개선했습니다.

**My Re Design**은 여러분의 진화와 성장을 위해 오늘도 최선을 다하고 있습니다.
지금 바로 업데이트하여 더 정교해진 목표 관리 시스템을 확인해 보세요!

감사합니다.
